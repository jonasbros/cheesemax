(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var r=n(12),s=n.n(r),a=n(37),c=n.n(a),l=(n(44),n(14)),i=(n(45),n(38)),o=n(27),u=(n(53),n(48),o.a.initializeApp({apiKey:"AIzaSyD_FOpZC2gs3zmc0VTNMYeI01m16CWTRs4",authDomain:"react-chat-f3838.firebaseapp.com",projectId:"react-chat-f3838",storageBucket:"react-chat-f3838.appspot.com",messagingSenderId:"151810268195",appId:"1:151810268195:web:297a5964e13902d8716596",measurementId:"G-W6RKDR17B6"})),d=o.a.firestore(),m=o.a.auth(),b=(o.a,n(9));var j=function(e){var t=e.btnProps,n=e.onClick,r="py-3 px-6";return"small"===t.size&&(r="py-0.5 px-4 text-sm h-8"),"fullheight"===t.size&&(r="h-full w-24"),Object(b.jsx)("button",{onClick:function(){n&&n()},className:"".concat(r," text-white rounded-md bg-").concat(t.color,"-500 hover:bg-").concat(t.color,"-700 transform transition-transform hover:-translate-y-0.5 hover:shadow-md"),type:t.type,children:t.text})};function f(){return Object(b.jsx)(j,{onClick:function(){var e=new o.a.auth.GoogleAuthProvider;m.signInWithPopup(e),m.onAuthStateChanged((function(e){if(e){var t=d.collection("users"),n=o.a.firestore.FieldValue.serverTimestamp;t.doc(e.uid).set({displayName:e.displayName,email:e.email,photoURL:e.photoURL,createdAt:n()})}}))},btnProps:{type:"button",color:"blue",text:"Sign in with Google"}})}var p=function(){return Object(b.jsxs)("main",{className:"w-full h-full flex flex-col items-center bg-yellow-200 mx-auto pt-20",children:[Object(b.jsx)("img",{className:"animate-bounce",src:"/logo.png",alt:"Cheesemax",height:"140",width:"140"}),Object(b.jsx)("h1",{className:"text-6xl text-blue-600 font-bold my-9 uppercase",children:"Cheesemax"}),f()]})},h=n(0),x=n.n(h),O=n(1),v=n(20),g=n(22),w=n(36),y=n.n(w);var N=function(e){var t=e.inputProps,n=e.onInput,r=e.onDebouncedInput,s=e.onClick,a=e.onBlur,c=y.a.debounce((function(e){r(e)}),500),l=y.a.debounce((function(){a()}),100);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("label",{className:t.labelHidden?"hidden":"",htmlFor:t.type,children:t.label}),Object(b.jsx)("input",{className:"p-4 w-full border-2 border-blue-300 rounded-md focus:outline-none focus:ring-2 ring-blue-500",id:t.type,type:t.type,placeholder:t.label,required:t.required,autoComplete:"pepelaugh",onKeyUp:function(e){n(),c(e.target)},onClick:function(e){return s(e.target)},onBlur:function(){return l()}})]})};var U=function(e){var t=e.src,n=e.alt,r=e.size,s=e.addedClass,a="h-12 w-12";return"small"===r&&(a="h-8 w-8"),Object(b.jsx)("img",{className:"rounded-full ".concat(a," ").concat(s),src:t,alt:n})};var k=function(e){var t=e.marsResults,n=e.addMarsState;function r(e){n(e),function(e){s.apply(this,arguments)}(e)}function s(){return(s=Object(O.a)(x.a.mark((function e(t){var n,r,s,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m.currentUser){e.next=10;break}return n=d.collection("mars"),r=n.doc(m.currentUser.uid+t.uid),e.next=5,r.get();case 5:s=e.sent,a=o.a.firestore.FieldValue.serverTimestamp,c=Object(g.a)(Object(g.a)({authUID:m.currentUser.uid},t),{},{lastMessageTime:a()}),console.log(s),s.exists||r.set(c);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(b.jsx)("div",{className:"absolute px-3 py-4 mt-1 bg-white rounded-md w-full",children:Object(b.jsx)("ul",{children:t.length?t.map((function(e){return Object(b.jsxs)("li",{className:"flex flex-row justify-between items-center mb-5 last:mb-0",children:[Object(b.jsx)(U,{src:e.photoURL,alt:e.displayName}),Object(b.jsxs)("div",{className:"mr-auto ml-3",children:[Object(b.jsx)("p",{className:"font-bold",children:e.displayName}),Object(b.jsx)("p",{className:"text-sm",children:e.email})]}),Object(b.jsx)(j,{onClick:function(){return r(e)},btnProps:{type:"button",text:"Add Mars",color:"blue",size:"small"}})]},e.uid)})):Object(b.jsx)("li",{children:Object(b.jsx)("p",{children:"Mars Not Found..."})})})})};var C=function(e){var t=e.onAddMars,n=Object(r.useState)(!1),s=Object(l.a)(n,2),a=s[0],c=s[1],i=Object(r.useState)([]),o=Object(l.a)(i,2),u=o[0],j=o[1];function f(e){return p.apply(this,arguments)}function p(){return(p=Object(O.a)(x.a.mark((function e(t){var n,r,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.value)){e.next=11;break}return e.next=4,d.collection("users").where("email","!=",m.currentUser.email).orderBy("email","asc").startAt(n).endAt(n+"\uf8ff").get();case 4:r=e.sent,s=[],r.forEach((function(e){s.push(Object(g.a)({uid:e.id},e.data()))})),j(s),c(a=!0),e.next=12;break;case 11:c(a=!1);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){c(a=!1)}return Object(b.jsxs)("div",{className:"mb-3 text-gray-700 relative",children:[Object(b.jsx)(N,{onDebouncedInput:f,onInput:h,onClick:f,onBlur:h,inputProps:{type:"text",labelHidden:!0,required:!1,label:"Search Mars Email... "}}),a&&Object(b.jsx)(k,{marsResults:u,addMarsState:function(e){e&&m.currentUser&&(t(e),c(a=!1)),console.log(e)}})]})};var I=function(e){var t=e.marsList,n=e.onClick;return Object(b.jsx)("div",{className:"w-full h-full rounded-md bg-blue-200 shadow-inner overflow-hidden",children:Object(b.jsx)("ul",{children:t.map((function(e){return Object(b.jsxs)("li",{className:"flex flex-row justify-between items-center mb-0.5 last:mb-0 p-3 bg-white",onClick:function(){return n(e)},children:[Object(b.jsx)(U,{src:e.photoURL,alt:e.displayName}),Object(b.jsxs)("div",{className:"mr-auto ml-3",children:[Object(b.jsx)("p",{className:"font-bold",children:e.displayName}),Object(b.jsx)("p",{className:"text-sm",children:e.email})]})]},e.uid)}))})})};var S=function(e){var t=e.onClickMarsListItem,n=Object(r.useState)([]),s=Object(l.a)(n,2),a=s[0],c=s[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(O.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m.currentUser){e.next=8;break}return e.next=3,d.collection("mars").orderBy("lastMessageTime","desc").where("authUID","==",m.currentUser.uid).get();case 3:t=e.sent,n=[],t.forEach((function(e){n.push(Object(g.a)({uid:e.id},e.data()))})),console.log(n),c(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(b.jsxs)("aside",{className:"col-span-1 p-4 bg-blue-300 flex flex-col sticky h-full",children:[Object(b.jsx)(C,{onAddMars:function(e){if(m.currentUser){var t=o.a.firestore.FieldValue.serverTimestamp,n=Object(g.a)(Object(g.a)({authUID:m.currentUser.uid},e),{},{lastMessageTime:t()});c([n].concat(Object(v.a)(a)))}}}),Object(b.jsx)(I,{marsList:a,onClick:function(e){return t(e)}})]})},L=n(39);var T=function(e){var t=e.message,n=t.senderUID===m.currentUser.uid,r=n?"ml-auto":"",s=n?"float-right":"float-left",a=t.sendTime&&t.sendTime.toDate().toLocaleString("en-US");return Object(b.jsxs)("li",{className:"".concat(r," block w-max mb-5"),children:[Object(b.jsx)(U,{addedClass:"".concat(s," mx-2"),src:n?m.currentUser.photoURL:t.senderPhoto,alt:t.displayName,size:"small"}),Object(b.jsxs)("div",{className:"inline-block rounded-md bg-blue-500 px-3 py-2",children:[Object(b.jsx)("p",{className:"text-xs text-white mb-1",children:a}),Object(b.jsx)("p",{className:"text-white",children:t.message})]})]})};var F=function(){return m.currentUser&&Object(b.jsx)(j,{onClick:function(){return m.signOut()},btnProps:{type:"button",color:"blue",text:"Sign out",size:"small"}})};var M=function(e){var t=e.marsChat,n=Object(r.useRef)(null),s=m.currentUser?m.currentUser.uid:"",a=d.collection("messages").orderBy("sendTime","asc").where("mars","in",[[s,t.uid],[t.uid,s]]).limit(30),c=Object(L.a)(a,{idField:"id"}),i=Object(l.a)(c,1)[0];function u(){if(m.currentUser&&n.current&&n.current.value&&t){var e=o.a.firestore.FieldValue.serverTimestamp,r={message:n.current.value,senderUID:m.currentUser.uid,mars:[m.currentUser.uid,t.uid],marsPhoto:t.photoURL,senderPhoto:m.currentUser.photoURL,sendTime:e()};d.collection("messages").doc().set(r),n.current.value=""}}return Object(b.jsxs)("section",{className:"relative col-span-3 flex flex-col justify-between bg-yellow-100 max-h-screen p-4",children:[Object(b.jsxs)("div",{className:"flex flex-row items-center w-full h-20 bg-yellow-300 absolute top-0 left-0 px-4 py-5 mb-4",children:[Object(b.jsx)(U,{src:t.photoURL,alt:t.displayName}),Object(b.jsxs)("div",{className:"mr-auto ml-3",children:[Object(b.jsx)("p",{className:"font-bold",children:t.displayName}),Object(b.jsx)("p",{className:"text-sm",children:t.email})]}),Object(b.jsx)(F,{})]}),Object(b.jsx)("ul",{className:"bg-white w-full h-full max-h-full bg-white rounded-md p-4 mb-3 mt-20 overflow-y-scroll",children:i&&i.map((function(e){return Object(b.jsx)(T,{message:e},e.id)}))}),Object(b.jsxs)("div",{className:"flex flex-row justify-between items-center w-full",children:[Object(b.jsx)("textarea",{ref:n,className:"resize-none w-full p-2 mr-3 rounded-md",rows:3,onKeyUp:function(e){return function(e){"Enter"===e.key&&u()}(e)}}),Object(b.jsx)(j,{onClick:u,btnProps:{type:"button",color:"blue",text:"Send",size:"fullheight"}})]})]})};var P=function(){var e=Object(r.useState)(null),t=Object(l.a)(e,2),n=t[0],s=t[1];function a(){return(a=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(b.jsxs)("main",{className:"relative grid grid-cols-4 h-full bg-yellow-100",children:[Object(b.jsx)(S,{onClickMarsListItem:function(e){s(e),function(e){a.apply(this,arguments)}(e)}}),n?Object(b.jsx)(M,{marsChat:n}):Object(b.jsx)("div",{className:"col-span-3 flex flex-row items-center w-full h-20 bg-yellow-300 px-4",children:Object(b.jsx)("div",{className:"ml-auto",children:Object(b.jsx)(F,{})})})]})};var R=function(){var e=Object(i.a)(m),t=Object(l.a)(e,1)[0];return Object(b.jsx)(b.Fragment,{children:t?Object(b.jsx)(P,{}):Object(b.jsx)(p,{})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))};c.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(R,{})}),document.getElementById("root")),D()}},[[52,1,2]]]);
//# sourceMappingURL=main.4207e8ae.chunk.js.map