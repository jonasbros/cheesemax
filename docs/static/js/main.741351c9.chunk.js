(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{44:function(e,t,r){},45:function(e,t,r){},52:function(e,t,r){"use strict";r.r(t);var n=r(12),s=r.n(n),a=r(37),c=r.n(a),l=(r(44),r(14)),i=(r(45),r(38)),o=r(26),u=(r(53),r(48),o.a.initializeApp({apiKey:"AIzaSyD_FOpZC2gs3zmc0VTNMYeI01m16CWTRs4",authDomain:"react-chat-f3838.firebaseapp.com",projectId:"react-chat-f3838",storageBucket:"react-chat-f3838.appspot.com",messagingSenderId:"151810268195",appId:"1:151810268195:web:297a5964e13902d8716596",measurementId:"G-W6RKDR17B6"})),d=o.a.firestore(),m=o.a.auth(),b=(o.a,r(9));var j=function(e){var t=e.btnProps,r=e.onClick,n="py-3 px-6";return"small"===t.size&&(n="py-0.5 px-4 text-sm h-8"),"fullheight"===t.size&&(n="h-full w-24"),Object(b.jsx)("button",{onClick:function(){r&&r()},className:"".concat(n," text-white rounded-md bg-").concat(t.color,"-500 hover:bg-").concat(t.color,"-700 transform transition-transform hover:-translate-y-0.5 hover:shadow-md"),type:t.type,children:t.text})};function p(){return Object(b.jsx)(j,{onClick:function(){var e=new o.a.auth.GoogleAuthProvider;m.signInWithPopup(e),m.onAuthStateChanged((function(e){if(e){var t=d.collection("users"),r=o.a.firestore.FieldValue.serverTimestamp;t.doc(e.uid).set({displayName:e.displayName,email:e.email,photoURL:e.photoURL,createdAt:r()})}}))},btnProps:{type:"button",color:"blue",text:"Sign in with Google"}})}var h=function(){return Object(b.jsxs)("main",{className:"w-full h-full flex flex-col items-center bg-yellow-200 mx-auto pt-20",children:[Object(b.jsx)("img",{className:"animate-bounce",src:"logo.png",alt:"Cheesemax",height:"140",width:"140"}),Object(b.jsx)("h1",{className:"text-6xl text-blue-600 font-bold my-9 uppercase",children:"Cheesemax"}),p()]})},f=r(33),x=r(0),O=r.n(x),v=r(39),g=r(1),y=r(36),w=r.n(y);var N=function(e){var t=e.inputProps,r=e.onInput,n=e.onDebouncedInput,s=e.onClick,a=e.onBlur,c=w.a.debounce((function(e){n(e)}),500),l=w.a.debounce((function(){a()}),100);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("label",{className:t.labelHidden?"hidden":"",htmlFor:t.type,children:t.label}),Object(b.jsx)("input",{className:"p-4 w-full border-2 border-blue-300 rounded-md focus:outline-none focus:ring-2 ring-blue-500",id:t.type,type:t.type,placeholder:t.label,required:t.required,autoComplete:"pepelaugh",onKeyUp:function(e){r(),c(e.target)},onClick:function(e){return s(e.target)},onBlur:function(){return l()}})]})},U=r(4);var C=function(e){var t=e.src,r=e.alt,n=e.size,s=e.addedClass,a="h-12 w-12";return"small"===n&&(a="h-8 w-8"),Object(b.jsx)("img",{className:"rounded-full ".concat(a," ").concat(s),src:t,alt:r})};var k=function(e){var t=e.marsResults,r=e.onAddMars;function n(e){r(),function(e){s.apply(this,arguments)}(e)}function s(){return(s=Object(g.a)(O.a.mark((function e(t){var r,n,s,a,c,l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m.currentUser){e.next=9;break}return n=d.collection("mars"),s=n.doc(m.currentUser.uid+t.uid),e.next=5,s.get();case 5:a=e.sent,c=o.a.firestore.FieldValue.serverTimestamp,r={mars:[t.uid,m.currentUser.uid]},Object(U.a)(r,m.currentUser.uid,{displayName:m.currentUser.displayName,photoURL:m.currentUser.photoURL,email:m.currentUser.email}),Object(U.a)(r,t.uid,{displayName:t.displayName,photoURL:t.photoURL,email:t.email}),Object(U.a)(r,"lastMessageTime",c()),l=r,a.exists||s.set(l);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(b.jsx)("div",{className:"absolute px-3 py-4 mt-1 bg-white rounded-md w-full",children:Object(b.jsx)("ul",{children:t.length?t.map((function(e){return Object(b.jsxs)("li",{className:"flex flex-row justify-between items-center mb-5 last:mb-0",children:[Object(b.jsx)(C,{src:e.photoURL,alt:e.displayName}),Object(b.jsxs)("div",{className:"mr-auto ml-3",children:[Object(b.jsx)("p",{className:"font-bold",children:e.displayName}),Object(b.jsx)("p",{className:"text-sm",children:e.email})]}),Object(b.jsx)(j,{onClick:function(){return n(e)},btnProps:{type:"button",text:"Add Mars",color:"blue",size:"small"}})]},e.uid)})):Object(b.jsx)("li",{children:Object(b.jsx)("p",{children:"Mars Not Found..."})})})})};var L=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),r=t[0],s=t[1],a=Object(n.useState)([]),c=Object(l.a)(a,2),i=c[0],o=c[1];function u(e){return j.apply(this,arguments)}function j(){return(j=Object(g.a)(O.a.mark((function e(t){var n,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.value)){e.next=11;break}return e.next=4,d.collection("users").where("email","!=",m.currentUser.email).orderBy("email","asc").startAt(n).endAt(n+"\uf8ff").get();case 4:a=e.sent,c=[],a.forEach((function(e){c.push(Object(v.a)({uid:e.id},e.data()))})),o(c),s(r=!0),e.next=12;break;case 11:p();case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){s(r=!1)}return Object(b.jsxs)("div",{className:"mb-3 text-gray-700 relative",children:[Object(b.jsx)(N,{onDebouncedInput:u,onInput:p,onClick:u,onBlur:p,inputProps:{type:"text",labelHidden:!0,required:!1,label:"Search Mars Email... "}}),r&&Object(b.jsx)(k,{marsResults:i,onAddMars:function(){p()}})]})};var R=function(e){var t=e.marsList,r=e.onClick;return Object(b.jsx)("div",{className:"w-full h-full rounded-md bg-blue-200 shadow-inner overflow-hidden",children:Object(b.jsx)("ul",{children:t.map((function(e){return Object(b.jsxs)("li",{className:"flex flex-row justify-between items-center mb-0.5 last:mb-0 p-3 bg-white",onClick:function(){return r(e)},children:[Object(b.jsx)(C,{src:e.photoURL,alt:e.displayName}),Object(b.jsxs)("div",{className:"mr-auto ml-3",children:[Object(b.jsx)("p",{className:"font-bold",children:e.displayName}),Object(b.jsx)("p",{className:"text-sm",children:e.email})]})]},e.uid)}))})})};var I=function(e){var t=e.onClickMarsListItem,r=d.collection("mars").orderBy("lastMessageTime","asc").where("mars","array-contains",m.currentUser.uid),n=Object(f.a)(r,{idField:"id"}),s=Object(l.a)(n,1)[0],a=[];return(null===s||void 0===s?void 0:s.length)&&(a=null===s||void 0===s?void 0:s.map((function(e,t,r){var n=e.mars.filter((function(e){return e!=m.currentUser.uid}))[0],s=r[t][n];return{uid:n,displayName:s.displayName,email:s.email,photoURL:s.photoURL}}))),Object(b.jsxs)("aside",{className:"col-span-1 p-4 bg-blue-300 flex flex-col sticky h-full max-h-full",children:[Object(b.jsx)(L,{}),Object(b.jsx)(R,{marsList:a,onClick:function(e){return t(e)}})]})};var F=function(e){var t=e.message,r=t.senderUID===m.currentUser.uid,n=r?"ml-auto":"",s=r?"float-right":"float-left",a=t.sendTime&&t.sendTime.toDate().toLocaleString("en-US");return Object(b.jsxs)("li",{className:"".concat(n," block w-max mb-5"),children:[Object(b.jsx)(C,{addedClass:"".concat(s," mx-2"),src:r?m.currentUser.photoURL:t.senderPhoto,alt:t.displayName,size:"small"}),Object(b.jsxs)("div",{className:"inline-block rounded-md bg-blue-500 px-3 py-2",children:[Object(b.jsx)("p",{className:"text-xs text-white mb-1",children:a}),Object(b.jsx)("p",{className:"text-white",children:t.message})]})]})};var P=function(){return m.currentUser&&Object(b.jsx)(j,{onClick:function(){return m.signOut()},btnProps:{type:"button",color:"blue",text:"Sign out",size:"small"}})};var S=function(e){var t=e.marsChat,r=Object(n.useRef)(null),s=m.currentUser?m.currentUser.uid:"",a=d.collection("messages").orderBy("sendTime","asc").where("mars","in",[[s,t.uid],[t.uid,s]]).limit(30),c=Object(f.a)(a,{idField:"id"}),i=Object(l.a)(c,1)[0];function u(){if(m.currentUser&&r.current&&r.current.value&&t){var e=o.a.firestore.FieldValue.serverTimestamp,n={message:r.current.value,senderUID:m.currentUser.uid,mars:[m.currentUser.uid,t.uid],marsPhoto:t.photoURL,senderPhoto:m.currentUser.photoURL,sendTime:e()};console.log(n),d.collection("messages").doc().set(n),r.current.value=""}}return Object(b.jsxs)("section",{className:"relative col-span-3 flex flex-col justify-between bg-yellow-100 max-h-screen p-4",children:[Object(b.jsxs)("div",{className:"flex flex-row items-center w-full h-20 bg-yellow-300 absolute top-0 left-0 px-4 py-5 mb-4",children:[Object(b.jsx)(C,{src:t.photoURL,alt:t.displayName}),Object(b.jsxs)("div",{className:"mr-auto ml-3",children:[Object(b.jsx)("p",{className:"font-bold",children:t.displayName}),Object(b.jsx)("p",{className:"text-sm",children:t.email})]}),Object(b.jsx)(P,{})]}),Object(b.jsx)("ul",{className:"bg-white w-full h-full max-h-full bg-white rounded-md p-4 mb-3 mt-20 overflow-y-scroll",children:i&&i.map((function(e){return Object(b.jsx)(F,{message:e},e.id)}))}),Object(b.jsxs)("div",{className:"flex flex-row justify-between items-center w-full",children:[Object(b.jsx)("textarea",{ref:r,className:"resize-none w-full p-2 mr-3 rounded-md",rows:3,onKeyUp:function(e){return function(e){"Enter"===e.key&&u()}(e)}}),Object(b.jsx)(j,{onClick:u,btnProps:{type:"button",color:"blue",text:"Send",size:"fullheight"}})]})]})};var T=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),r=t[0],s=t[1];return Object(b.jsxs)("main",{className:"relative grid grid-cols-4 h-full bg-yellow-100",children:[Object(b.jsx)(I,{onClickMarsListItem:function(e){console.log(e),s(e)}}),r?Object(b.jsx)(S,{marsChat:r}):Object(b.jsx)("div",{className:"col-span-3 flex flex-row items-center w-full h-20 bg-yellow-300 px-4",children:Object(b.jsx)("div",{className:"ml-auto",children:Object(b.jsx)(P,{})})})]})};var z=function(){var e=Object(i.a)(m),t=Object(l.a)(e,1)[0];return Object(b.jsx)(b.Fragment,{children:t?Object(b.jsx)(T,{}):Object(b.jsx)(h,{})})},M=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,54)).then((function(t){var r=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;r(e),n(e),s(e),a(e),c(e)}))};c.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(z,{})}),document.getElementById("root")),M()}},[[52,1,2]]]);
//# sourceMappingURL=main.741351c9.chunk.js.map
